<?xml version="1.0"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
    <?include BuildVars.wxi ?>

    <Bundle 
            Name="$(var.productName) Bundle"
            Manufacturer="$(var.companyName)"
            Version="$(var.releaseVersionFull)"
            IconSourceFile="favicon.ico"
            UpgradeCode="$(var.fullBundleUpgradeCode)"
            DisableModify="yes">
        <util:RegistrySearchRef Id='SearchForIsConnectedToCloud' />
        <util:RegistrySearchRef Id='ArchRegistrySearch' />

        <BootstrapperApplicationRef Id="WixExtendedBootstrapperApplication.HyperlinkLicense">
            <Payload SourceFile="License.html" />
            <Payload SourceFile="installer_bg.png" />
            <Payload SourceFile="logo_big.png" />
            <Payload SourceFile="logo_small.png" />

            <bal:WixExtendedBootstrapperApplication SuppressOptionsUI="no" LicenseUrl="License.html" />
        </BootstrapperApplicationRef>

        <WixVariable Id="WixExtbaThemeXml" Value="OptixTheme.xml" />
        <WixVariable Id="WixExtbaThemeWxl" Value="OptixTheme.wxl" />

        <Variable Name="InstallClientAndServer" Type="numeric" Value="1" />
        <Variable Name="InstallClientOnly" Type="numeric" Value="0" />
        <Variable Name="InstallServerOnly" Type="numeric" Value="0" />

<!--        <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense">
            <bal:WixStandardBootstrapperApplication
                LicenseFile="License.rtf"
                LogoFile="logo-64x64.png"
                SuppressRepair="yes"
                SuppressOptionsUI="yes"
                ShowFilesInUse="yes"
                LaunchTarget="$(var.clientInstallFullPath)\$(var.releaseVersionFull)\$(var.minilauncherBinaryName)"
            />
        </BootstrapperApplicationRef> -->

        <Chain DisableSystemRestore="yes">
            <PackageGroupRef Id="ClientPackageGroup"/>
            <PackageGroupRef Id="ServerPackageGroup"/>

<!--            <MsiPackage
                Id="ClientPackage"
                Name="$(var.ClientMsiName)"
                SourceFile="bin/strip/$(var.ClientMsiName)"
                Vital="yes"
                Cache="no"
                Compressed="yes">
                <MsiProperty Name="LICENSE_ALREADY_ACCEPTED" Value="1" />
            </MsiPackage>

            <MsiPackage
                Id="ServerPackage"
                Name="$(var.ServerMsiName)"
                SourceFile="bin/strip/$(var.ServerMsiName)"
                Vital="yes"
                Cache="no"
                Compressed="yes">
                <MsiProperty Name="LICENSE_ALREADY_ACCEPTED" Value="1" />
            </MsiPackage> -->
        </Chain>
    </Bundle>
</Wix>