<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension"
     xmlns:fire="http://schemas.microsoft.com/wix/FirewallExtension">
    <Fragment Id='FragmentTraytool'>
        <?include BuildVars.wxi ?>

        <DirectoryRef Id="INSTALLDIR">
             <Directory Id="${customization}TrayToolDir" Name="TrayTool">
                 <Directory Id="TraytoolPlatforms" Name="platforms"/>
                 <Component Id="traytool.exe">
                     <File Id="traytool.exe" Name="traytool.exe" Source="$(var.SourceDir)/traytool.exe" KeyPath="yes">
                         <fire:FirewallException Id="FirewallException${customization}TrayTool" Name="VMS Tray Tool" Scope="any" IgnoreFailure="yes"/>

                         <Shortcut Id="StartmenuTrayTool" Directory="ProgramMenuDir" Name="${traytool.name}"
                                   WorkingDirectory='${customization}TrayToolDir' Advertise="yes" Icon="icon_menu.exe">
                         </Shortcut>

                         <Shortcut Id="StartmenuStartupTrayTool" Directory="StartupFolder" Name="${traytool.name}"
                                   WorkingDirectory='${customization}TrayToolDir' Advertise="yes" Icon="icon_menu.exe">
                         </Shortcut>
                     </File>
                 </Component>
             </Directory>
        </DirectoryRef>

        <ComponentGroup Id="TrayToolLibs" Directory="${customization}TrayToolDir">
            <Component>
                <File Id="TrayToolUtilsLib" Name="nx_utils.dll" Source="$(var.SourceDir)/nx_utils.dll" DiskId="4" />
            </Component>
        </ComponentGroup>        
        
        <ComponentGroup Id="TrayToolQTLibraries" Directory="${customization}TrayToolDir">
            <Component>
                <File Id="TrayToolicudt53.dll" Name="icudt53.dll" Source="$(var.QtDir)\icudt53.dll" DiskId="5" />                
            </Component>                 
            <Component>
                <File Id="TrayToolicuin53.dll" Name="icuin53.dll" Source="$(var.QtDir)\icuin53.dll" DiskId="5" />                
            </Component>                 
            <Component>
                <File Id="TrayToolicuuc53.dll" Name="icuuc53.dll" Source="$(var.QtDir)\icuuc53.dll" DiskId="5" />                
            </Component>        
            <Component>
                <File Id="TrayToolQt5Core.dll" Name="Qt5Core.dll" Source="$(var.QtDir)\Qt5Core.dll" DiskId="7" />       
            </Component>
            <Component>
                <File Id="TrayToolQt5Gui.dll" Name="Qt5Gui.dll" Source="$(var.QtDir)\Qt5Gui.dll" DiskId="7" />
            </Component>
            <Component>
                <File Id="TrayToolQt5Network.dll" Name="Qt5Network.dll" Source="$(var.QtDir)\Qt5Network.dll" DiskId="8" />
            </Component>            
            <Component>
                <File Id="Qt5Widgets.dll" Name="Qt5Widgets.dll" Source="$(var.QtDir)\Qt5Widgets.dll" DiskId="9" />
            </Component>                 
        </ComponentGroup>

        <ComponentGroup Id="TraytoolPlatforms" Directory="TraytoolPlatforms">
            <Component>
                <File Id="qwindows.dll" Name="qwindows.dll" Source="$(var.QtPluginsDir)\platforms\qwindows.dll" DiskId="9" />
            </Component>      
        </ComponentGroup>         

    </Fragment>
</Wix>