<div class="container">
    <div class="row">
        <div class="col-md-4 col-md-push-8">
            <system-info></system-info>
        </div>
        <div class="col-md-8 col-md-pull-4">
            <alert type="danger" ng-if="settings.flags.noHDD">
                อุปกรณ์นี้มีวัตถุประสงค์เพื่อทำงานกับฮาร์ดดิสก์ที่ติดตั้ง <br>กรุณาปิดอุปกรณ์ และติดตั้งฮาร์ดดิสก์ไดรฟ์
            </alert>
            <alert type="danger" ng-if="!settings.flags.noHDD && settings.flags.noNetwork">
                อุปกรณ์นี้ต้องการเชื่อมต่อเครือข่ายการทำงาน <br>โปรดเชื่อมต่อกับท้องถิ่น ot ของเครือข่ายอินเทอร์เน็ต
            </alert>
            <alert type="danger" ng-if="!settings.flags.noHDD && !settings.flags.noNetwork && settings.flags.wrongNetwork">
                อุปกรณ์นี้มีการกำหนดค่าเครือข่ายไม่ถูกต้อง <br>โปรดเชื่อมต่อกับเครือข่าย หรือกำหนดที่อยู่ IP ถูกต้อง
            </alert>


            <tabset ng-hide="settings.flags.brokenSystem || settings.flags.cleanSystem">
                <tab heading="{{L.settings.tabs.server}}" active="active.server">
                    <div>
                        <form novalidate name="settingsForm" class="form-horizontal" role="form" >
                            <h3>พอร์ท</h3>
                            <div class="form-group" ng-class="{'has-error':!settingsForm.port.$valid}">
                                <div class="col-xs-6">
                                    <input type="number" class="form-control" id="port" placeholder="พอร์ท" name="port" ng-model="settings.port"
                                           min="1"  max="65000"
                                           pattern ="^\d*$" required>
                                </div>

                                <div class="col-xs-6">
                                    <button type="button" class="btn btn-primary" ng-disabled="!settingsForm.$valid" ng-click="save()">เปลี่ยนพอร์ต</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div>
                        <h3>รีเซ็ตเซิร์ฟเวอร์</h3>
                        <p>การดำเนินการนี้จะเปลี่ยนเซิร์ฟเวอร์นี้เป็นค่าเริ่มต้น (ล้างฐานข้อมูลและตั้งค่าใหม่)
                            เซิร์ฟเวอร์ที่จะแยกออกจากระบบปัจจุบัน ที่เก็บวิดีโอจะยังคงเดิม</p>
                        <p><button type="button" class="btn btn-default" ng-click="openRestoreDefaultsDialog()">เรียกคืนค่าเริ่มต้นจากโรงงาน</button></p>
                    </div>
                    <div>
                        <h3>แยกออกจากระบบเซิร์ฟเวอร์</h3>
                        <p>การดำเนินการนี้จะแยกเซิร์ฟเวอร์จากระบบที่เก็บรักษาฐานข้อมูลผู้ใช้ภายในและการกำหนดค่า ที่เก็บวิดีโอจะยังคงเดิม <b> ผู้ใช้ระบบคลาวด์จะถูกลบ </b></p>
                        <p><button class="btn btn-default" ng-click="disconnectFromSystem()">แยกออกจากระบบ</button></p>
                    </div>
                    <div>
                        <h3>รีสตาร์ท</h3>
                        <p><button type="button" class="btn btn-default" ng-click="restart()"> รีสตาร์ทเซิร์ฟเวอร์ </button> <button type="button" class="btn btn-default" ng-if="canHardwareRestart" ng-click="hardwareRestart()"> Reboot </button></p>
                    </div>
                    <div ng-if="user.isOwner">
                        <form novalidate name="rootPasswordForm" class="form-horizontal" role="form">
                            <h3>เปลี่ยนรหัสผ่านผู้ดูแลระบบ</h3>
                            <p>ถ้าระบบอยู่ในระบบ (ไม่ได้เชื่อมต่อกับระบบคลาวด์) ระบบจะเปลี่ยนรหัสผ่านสำหรับผู้ใช้ "admin" และรหัสผ่านการกู้คืน (root) บนเซิร์ฟเวอร์บางเครื่อง <br> มิฉะนั้นจะเป็นการเปลี่ยนรหัสผ่านการกู้คืนเท่านั้น</p>
                            <div class="col-sm-6">
                                <password-input auto-focus="false" ng-model="settings.rootPassword"></password-input>
                            </div>

                            <div class="col-sm-6">
                                <button type="button" class="btn btn-primary" ng-disabled="!rootPasswordForm.$valid"
                                        ng-click="changePassword()">เปลี่ยนรหัสผ่าน</button>
                            </div>
                        </form>
                    </div>
                </tab>

                <tab heading="{{L.settings.tabs.system}}" active="active.system">
                    <div>
                        <h3>ชื่อ</h3>
                        <div class="row">
                            <div class="col-md-6">
                                <input class="form-control" type="text" ng-model="settings.systemName">
                            </div>

                            <div class="col-md-6">
                                <button type="button" class="btn btn-default" ng-click="renameSystem()">เปลี่ยนชื่อระบบ</button>
                            </div>
                        </div>
                    </div>

                    <div ng-if="canMerge" >
                        <form class="form-horizontal" >
                            <h3>รวมระบบ</h3>
                            <p><button type="button" class="btn btn-default" ng-click="openJoinDialog()">รวมระบบ</button></p>
                        </form>
                    </div>

                    <div>
                        <h3>{{Config.cloud.productName}}</h3>

                        <div ng-if="cloudSystemID">
                            <p>ระบบนี้เชื่อมโยงกับ {{Config.cloud.productName}} เจ้าของระบบ: <b> {{cloudAccountName}} </b></p>
                            <p ng-if="canConnectToCloud"><button class="btn btn-default" ng-click="disconnectFromCloud()">ตัดการเชื่อมต่อจาก {{Config.cloud.productName}}</button></p>
                            <p><a ng-if="!mode.liteClient"
                                  ng-href="{{Config.cloud.portalUrl}}{{Config.cloud.portalSystemUrl.replace('{systemId}',cloudSystemID) + Config.cloud.webadminContext}}"
                                  target="_blank">ไปที่ {{Config.cloud.productName}} พอร์ทัล</a></p>
                        </div>

                        <div ng-if="!cloudSystemID">
                            <alert type="warning">ระบบนี้ไม่ได้เชื่อมโยงกับ {{Config.cloud.productName}} <a ng-if="!mode.liteClient"
                                   ng-href="{{Config.cloud.portalUrl}}"
                                   target="_blank"> เรียนรู้เพิ่มเติม </a></alert>
                            <alert type="error" ng-if="!hasInternetOnServer">เชื่อมต่อเซิร์ฟเวอร์กับอินเทอร์เน็ตเพื่อดำเนินการติดตั้ง {{Config.cloud.productName}}</alert>
                            <alert type="error" ng-if="hasInternetOnServer && !hasInternetOnClient">Internet connection required to connect System to {{Config.cloud.productName}}</alert>
                            <p ng-if="canConnectToCloud"  ><button
                                    class="btn btn-default"
                                    ng-click="connectToCloud()" ng-disabled="!hasInternetOnServer || !hasInternetOnClient">Connect to {{Config.cloud.productName}}</button>
                                <a ng-if="!mode.liteClient"  class="btn btn-default"
                                   ng-href="{{Config.cloud.portalUrl + Config.cloud.portalRegisterUrl + Config.cloud.webadminContext}}"
                                   target="_blank">Create {{Config.cloud.productName}} Account</a></p>
                        </div>
                    </div>
                </tab>

                <tab heading="{{L.settings.tabs.device}}" active="active.device" ng-if="controlDevice">
                    <div ng-if="settings.flags.canSetupNetwork">
                        <h3>Device Network Settings</h3>
                        <network-settings settings="networkSettings[0]" ng-if="networkSettings"></network-settings>
                        <button class="btn btn-default" ng-click="saveNetworkSettings()">Save settings and reboot the device</button>
                    </div>
                    <div ng-if="settings.flags.canSetupTime">
                        <h3>Date and Time</h3>
                        <form name="timeSettings">
                            <table>
                                <tbody>
                                    <tr>
                                        <td><label for="timeZone">Time zone</label></td>
                                        <td><label for="date">วันที่</label></td>
                                        <td><label for="time">เวลา</label></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td><select class="form-control"
                                                    ng-options="zone.id as zone.name for zone in timeZones"
                                                    id="timeZone"
                                                    name="timeZone"
                                                    ng-model="dateTimeSettings.timeZone"
                                                    required></select></td>
                                        <td>
                                            <div class="input-group">
                                                <input type="text"
                                                       id="date" name="date"
                                                       class="form-control"
                                                       datepicker-popup="{{Config.dateSettingsFormat}}"
                                                       ng-model="dateTimeSettings.dateTime"
                                                       required
 is-open="dateTimeSettings.openDate"
                                                       close-text="Close" />
                                                <span class="input-group-btn">
                                                    <button type="button"
                                                            class="btn btn-default"
                                                            ng-click="openDatePicker($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                                                </span>
                                            </div>
                                        </td>
                                        <td>
                                            <input class="form-control" ng-model="dateTimeSettings.dateTime" ui-timepicker>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </form>
                        <button class="btn btn-default" ng-click="saveDateTime()">Save Date and Time</button>
                    </div>
                    <div ng-if="(canRestoreSettings || canRestoreSettingsNotNetwork)">
                        <h3>Restore Server Settings</h3>
                        <p><button type="button" class="btn btn-default" ng-if="canRestoreSettings" ng-click="restoreSettings()">Full Restore</button>
                            <button type="button" class="btn btn-default" ng-if="canRestoreSettingsNotNetwork" ng-click="restoreSettingsNotNetwork()">Restore Everything But Network</button></p>
                    </div>
                    <div ng-if="canRunClient || canStopClient">
                        <h3>Run client application on server</h3>
                        <p><button type="button" class="btn btn-default" ng-if="canRunClient" ng-click="runClient()">Run client</button>
                            <button type="button" class="btn btn-default" ng-if="canStopClient" ng-click="stopClient()">Stop client</button></p>
                        <p>Use a keyboard/mouse or mobile application to control it.</p>
                    </div>
                </tab>
            </tabset>
        </div>
    </div>
</div>