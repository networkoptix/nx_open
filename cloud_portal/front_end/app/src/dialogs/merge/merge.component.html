<div class="modal-header">
    <h1 class="modal-title" translate>Merge Systems</h1>
    <button type="button" class="close"
            data-dismiss="modal" aria-label="Close"
            (click)="activeModal.close()" *ngIf="closable">
        <div class="close-content"><span class="close-icon"></span></div>
    </button>
</div>

<div *ngIf="!showMergeForm">
    <div class="modal-body">
        <div>
            <p class="help-block-no-height" translate>
                You can merge only those cloud Systems, where you have the "Owner" permissions.
            </p>
            <p class="help-block-no-height" translate>
                Connect System you want to merge with this one to %PRODUCT_NAME% or merge locally using %VMS_NAME% Client.
            </p>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button"
                class="btn btn-primary wide-button" (click)="activeModal.close()">
            {{ 'Ok' | translate}}
        </button>
    </div>
</div>

<form *ngIf="showMergeForm" #mergeForm="ngForm" name="mergeForm" novalidate>
    <div class="modal-body">
        <div class="form-group">
            <label for="system" translate>Merge current System with</label>
            <nx-select [items]="systemsSelect" [selected]="targetSystem" (onSelected)="setTargetSystem($event)"></nx-select>
        </div>
        <p *ngIf="systemMergeable =='offline'"
           class="help-block-no-height warning-label" translate>
            <span translate>System</span><span>&nbsp;{{targetSystem.name}}&nbsp;</span><span translate>is offline.</span>&nbsp;
            <span translate>Cannot be merged with the current one.</span>
        </p>
        <p *ngIf="systemMergeable =='cannotMerge'"
           class="help-block-no-height warning-label" translate>
            <span translate>System</span><span>&nbsp;{{targetSystem.name}}&nbsp;</span><span translate>is incompatible.</span>&nbsp;
            <span translate>Cannot be merged with the current one.</span>
        </p>
        <p *ngIf="systemMergeable == ''"
           class="help-block-no-height" translate>You can only merge Systems in which you have owner permissions.</p>
        <div>
            <div [ngClass]="{'text-muted': systemMergeable != ''}" translate>Took system name and settings from</div>
            <div>
                <div class="radio-group">
                    <label class="option">
                        <input type="radio"
                               name="firstSystem" id="firstSystem"
                               [(ngModel)]="masterId"
                               [value]="system.id"
                               [checked]="system.id == masterId"
                               [disabled]="systemMergeable != ''">
                        <span class="optionmark">
                            <svg viewBox="0 0 20 16">
                                <path class="circle" d="M8,2c3.3,0,6,2.7,6,6s-2.7,6-6,6s-6-2.7-6-6S4.7,2,8,2 M8,1C4.1,1,1,4.1,1,8s3.1,7,7,7s7-3.1,7-7S11.9,1,8,1L8,1z"></path>
                                <circle cx="8" cy="8" r="4"></circle>
                            </svg>
                        </span>
                        <span [innerHtml]="system.info.name"></span>
                    </label>
                </div>
                <div class="radio-group">
                    <label class="option">
                        <input type="radio"
                               name="secondSystem" id="secondSystem"
                               [(ngModel)]="masterId"
                               [value]="targetSystem.id"
                               [checked]="targetSystem.id == masterId"
                               [disabled]="systemMergeable != ''">
                        <span class="optionmark">
                            <svg viewBox="0 0 20 16">
                                <path class="circle" d="M8,2c3.3,0,6,2.7,6,6s-2.7,6-6,6s-6-2.7-6-6S4.7,2,8,2 M8,1C4.1,1,1,4.1,1,8s3.1,7,7,7s7-3.1,7-7S11.9,1,8,1L8,1z"></path>
                                <circle cx="8" cy="8" r="4"></circle>
                            </svg>
                        </span>
                        <span [innerHtml]="targetSystem.name"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <nx-process-button [buttonDisabled]="systemMergeable != ''"
                           [process]="merging"
                           [form]="mergeForm"
                           actionType="primary"
                           buttonText="{{ 'Merge' | translate}}"></nx-process-button>
    </div>
</form>
