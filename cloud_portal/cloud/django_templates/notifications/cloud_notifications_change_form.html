{% extends "admin/change_form.html" %}
{% load i18n admin_urls static admin_modify %}
{% block content %}
    <form id="notificationForm" action="{% url 'cloud_notification' %}" method="post" class="aligned" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="id" value="{{original.id}}">
        {% for fieldset in adminform %}
            {% if fieldset.name != 'Target Customizations' or original and perms.notifications.send_cloud_notification%}
                {% include "admin/includes/fieldset.html" %}
            {% endif %}
        {% endfor %}
        {% block submit_buttons_bottom %}{% endblock %}
        {% if not original.sent_date %}
        <div style="text-align:right">
            {% if BROADCAST_NOTIFICATIONS_SUPERUSERS_ONLY %}
            <h1>Send notifications to superusers only</h1>
            {% else %}
            <h1 style="color:red">Send notifications to all users</h1>
            {% endif %}
        </div>
        <div class="submit-row">
            {% if perms.notifications.delete_cloudnotification %}
            {% url opts|admin_urlname:'delete' original.pk|admin_urlquote as delete_url %}
            <a class="btn btn-sm btn-danger pull-left" href="{% add_preserved_filters delete_url %}">Delete</a>
            </a>
            {% endif %}
            <label for="ignoreSubscriptions">Ignore Subscriptions:</label>
            <input class="float-left" id="ignoreSubscriptions" name="ignore_subscriptions" type="checkbox">
            <button class="btn btn-sm btn-primary" type="submit" name="Save">Save Draft</button>
            <button class="btn btn-sm btn-default" type="submit" name="Preview">Save and Preview Draft</button>
            {% if perms.notifications.send_cloud_notification %}
            <button class="btn btn-sm btn-success" type="submit" name="Send" {%if not original %} disabled {% endif %}>Save and Send Notification</button>
            {% endif %}
            <button class="btn btn-sm btn-danger" type="reset"  name="Reset">Reset</button>
        </div>
        {% endif %}
    </form>
{% endblock %}
