# This file describes actual state of things on Test Camera Stand (dev-stand) in 192.168.200.* network.
# Ask @syuldashev if there are any problems with hardware.


SERVER_STAGES:
  before if features.mediaserver_metrics:
    api/metrics?brief:
      offlineStatus: 0
      transactions: {"errors": 0, "local": [1, 2], "success": [20, 30]}

  after if features.mediaserver_metrics:
    api/metrics?brief:
      offlineStatus: 0
      transactions: {"errors": 0, "local": [1, 5], "success": [500, 600]}

  delayed if features.mediaserver_metrics:
    api/metrics?brief:
      offlineStatus: 0]
      transactions: {"errors": 0, "local": [1, 5], "success": [500, 600]}


Axis_M3046V:
  discovery:
    physicalId: AC-CC-8E-95-33-57
    vendor: Axis
    model: AXISM3046V

  authorization:
    password: auto

  attributes:
    firmware: 7.40.1
    isAudioSupported: 0

  recording:
    primary: {codec: 'H264', resolution: '2688x1520', fps: [[13, 17], [20, 30]]}
    secondary: {codec: 'H264', resolution: '640x360', fps: [5, 10]}

  video_parameters:
    primary:
      - {codec: 'MJPEG', resolution: '1280x960'}
      - {codec: 'H264', resolution: '2688x1520'}
    secondary:
      - {codec: 'MJPEG', resolution: '1280x720', fps: [24, 36]}
      - {codec: 'H264', resolution: '640x480', fps: [24, 36]}  # TODO: Different FPS.
    stream_urls:
      "1": "rtsp://192.168.200.10:554/axis-media/media.amp?streamprofile=hdwitnessPrimary"
      "2": "rtsp://192.168.200.10:554/axis-media/media.amp?streamprofile=hdwitnessSecondary"


# Needs a reboot every time. Camera is VERY BUGGY!
DWC-MD421D_1.1.1.8:

  discovery:
    physicalId: 00-1C-A6-01-21-97
    vendor: Digital Watchdog
    model: DWC-MD421D

  authorization if False: # Camera needs firmware upgrade to v.1.1.2.x
    password: auto

  attributes:
    firmware: 1.1.1.8
    isAudioSupported: 1
    ptzCapabilities: 12  # Zoom + Focus.

  attributes if features.advanced_lens_control:
    ptzCapabilities: 8405004

  recording:
    primary: {'codec': 'H264', 'resolution': '1920x1080', 'fps': [[13, 17], [8, 12]]}
    secondary: {'codec': 'H264', 'resolution': '640x352', 'fps': [5, 10]}

  video_parameters:
    primary:
      - {'codec': 'H264', 'resolution': '1920x1080'}
      - {'codec': 'H264', 'resolution': '960x544'}
    secondary:
      - {'codec': 'H264', 'resolution': '640x352', 'fps': [8, 12]}
      #- {'codec': 'H264', 'resolution': '320x240', 'fps': [24, 36]}
    stream_urls:
      '1': "rtsp://192.168.200.13:554/h264"
      '2': "rtsp://192.168.200.13:8554/h264"

  # Not sure if it has audio_parameters, but isAudioSupported == 1.
  audio_parameters if False:
    - {'skip_codec_change': True, 'codec': 'MP2'}

  io_events:
    ins: [{id: '1'}]
    outs: [{id: 't_RelayOut-0'}]


DWC-MD421D_1.1.2.0:
  discovery:
    physicalId: 00-1C-A6-01-27-1A
    vendor: Digital Watchdog
    model: DWC-MD421D

  authorization:
    password: auto

  attributes:
    firmware: 1.1.2.0
    isAudioSupported: 1
    ptzCapabilities: 12  # Zoom + Focus.

  attributes if features.advanced_lens_control:
    ptzCapabilities: 8405004

  recording:
    primary: {codec: 'H264', resolution: '1920x1080', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '640x352', fps: [5, 10]}

  video_parameters:
    primary:
      - {codec: 'H264', resolution: '1920x1080'}
      - {codec: 'H264', resolution: '960x544'}
    secondary:
      - {codec: 'H264', resolution: '640x352', fps: [8, 12]}
      - {codec: 'H264', resolution: '704x528', fps: [24, 36]}
    stream_urls:
      '1': "rtsp://192.168.200.14:554/h264"
      '2': "rtsp://192.168.200.14:8554/h264"

  # FFmpeg is unable to discover any streams when audio is enabled.
  audio_parameters:
    - {'skip_codec_change': True, codec: 'MP2'}

  io_events:
    ins: [{id: '1'}]
    outs: [{id: 't_RelayOut-0'}]


DWC-MPA20M:
  discovery:
    physicalId: 00-1C-A6-01-20-A4
    vendor: Digital Watchdog
    model: DWC-MPA20M

  authorization:
    password: auto

  attributes:
    firmware: 1.1.1.12
    isAudioSupported: 0

  recording:
    primary: {codec: 'H264', resolution: '1920x1080', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '640x352', fps: [5, 10]}

  video_parameters:
    primary:
      - {codec: 'H264', resolution: '1920x1080'}
      #- {codec: 'H264', resolution: '960x720'} # Causes FFmpeg to return None.
      - {codec: 'H264', resolution: '1280x720'}
    secondary:
      - {codec: 'H264', resolution: '640x352', fps: [8, 12]}
      - {codec: 'H264', resolution: '320x240', fps: [24, 36]}
    stream_urls:
      '1': "rtsp://192.168.200.19:1554/h264"
      '2': "rtsp://192.168.200.19:8554/h264"


DWC-MV421TIR:
  discovery:
    physicalId: urn_uuid_32313262-3332-6666-3831-000df1212b32
    vendor: Digital Watchdog
    model: DWC-MV421TIR
    mac: 00-0D-F1-21-2B-32

  authorization:
    password: auto

  attributes:
    firmware: A1.1.2
    isAudioSupported: 1
    ptzCapabilities: 4  # Zoom.

  attributes if features.advanced_lens_control:
    ptzCapabilities: 16388

  # FIXME: There is a bug: no matter which FPS you set for recording, it's always 30.
  recording:
    primary: {codec: 'H264', resolution: '1920x1080', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '352x288', fps: [5, 10]}

  video_parameters:
    primary:
      - {codec: 'H264', resolution: '1920x1080'}
      #- {codec: 'MJPEG', resolution: '1280x960'}
    #secondary:
      #- {codec: 'H264', resolution: '640x352', fps: [8, 12]}
      #- {codec: 'MJPEG', resolution: '320x240', fps: [24, 36]}

  # Didn't find any data on supported audio_parameters codecs. This needs checking
  # "Audio stream was not discovered by ffprobe."
  audio_parameters:
    - {'skip_codec_change': True, codec: 'MP2'}

  io_events:
    ins: [{id: '1'}]
    outs: [{id: 'relay01'}]


DWC-MV84WiAC6:
  discovery:
    physicalId: urn_uuid_32313534-3532-6666-3338-000df1215452
    vendor: Digital Watchdog
    model: DWC-MV84WiAC6
    mac: 00-0D-F1-21-54-52

  authorization:
    password: auto

  attributes:
    firmware: A4.1.2
    isAudioSupported: 0
    ptzCapabilities: 4  # Zoom.

  attributes if features.advanced_lens_control:
    ptzCapabilities: 16388

  recording:
    primary: {codec: 'H264', resolution: '2560x1440', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '352x288', fps: [4, 8]}

  video_parameters:
    primary: # Exact supported fps/res values are not in the spec. Adjusting may be needed
      - {codec: 'H264', resolution: '2560x1440'}
      #- {codec: 'MJPEG', resolution: '1280x960'}
    #secondary:
      #- {codec: 'H264', resolution: '352x288', fps: [8, 12]}
      #- {codec: 'MJPEG', resolution: '640x480', fps: [24, 36]}


DWC-PVX16W:
  discovery:
    physicalId: urn_uuid_32313563-6163-6665-6436-000df1215cac
    vendor: Digital Watchdog
    model: DWC-PVX16W
    mac: 00-0D-F1-21-5C-AC

  authorization:
    password: auto

  attributes:
    firmware: S2.1.3_2018.03.09
    isAudioSupported: 1
    ptzCapabilities: 4  # Zoom.

  attributes if features.advanced_lens_control:
    ptzCapabilities: 16388

  recording:
    primary: {codec: 'H264', resolution: '2560x1440', fps: [[25, 35]]} # TODO: Add more FPS.
    secondary: {codec: 'H264', resolution: '352x240', fps: [3, 8]}
    # Although in all_cameras.json range is "352x240,352x288, 640x480,704x480,704x576", 352x240
    # is applied when trying to use 352x288. Bug on the server or camera?

  # No normal specs, fps/res may require adjusting
  video_parameters:
    #"Video stream was not discovered by ffprobe."
    primary:
      - {codec: 'H264', resolution: '2560x1440'}
      #- {codec: 'MJPEG', resolution: '1280x960'}
    #secondary:
      #- {codec: 'H264', resolution: '352x288', fps: [8, 12]}
      #- {codec: 'MJPEG', resolution: '640x480', fps: [24, 36]}

  # Didn't find any data on supported audio_parameters codecs. This needs checking.
  #"Audio stream was not discovered by ffprobe. Seems, there's no sound on the cam."
  audio_parameters if False:
    - {'skip_codec_change': True, codec: 'G711'}

  io_events:
    ins: [{id: '1'}]
    outs: [{id: 'relay01'}]


Hanwha_PNM-9020V:
  discovery if customization in ('default', 'hanwha') and version >= '3.1.1':
    physicalId: 00-09-18-4F-74-4E
    vendor: Hanwha Techwin
    model: PNM-9020V

  authorization:
    login: admin
    password: Samsung1

  attributes:
    firmware: '1.01_161214'

  recording:
    primary: {codec: 'H264', resolution: '4096x1800', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '512x224', fps: [5, 10]}

  video_parameters:
    primary:
    - {codec: 'H264', resolution: '4096x1800'}
    - {codec: 'H265', resolution: '3584x1576'}
    # - {codec: 'MJPEG', resolution: '3072x1352'} # 'video.resolution' is '1024x1352', expected '3072x1352'
    secondary:
    - {codec: 'H264', resolution: '512x224', fps: [24, 36]}
    - {codec: 'H265', resolution: '1024x452', fps: [8, 12]}
    stream_urls:
      "1": "rtsp://192.168.200.12:554/profile4/media.smp"
      "2": "rtsp://192.168.200.12:554/profile5/media.smp"

  audio_parameters if False:
    - {codec: 'AAC'}  # The camera has audio_parameters input, but ffprobe does not
    - {codec: 'G711'} # detect any sound. Need to connect a mic???

  io_events:
    ins: [{id: 'AlarmInput.1', name: 'Alarm Input #1'}]
    outs: [{id: 'AlarmOutput.1', name: 'Alarm Output #1'}]


Hanwha_XNP-6120H:
  discovery if customization in ('default', 'hanwha') and version >= '3.1.1':
    physicalId: 00-09-18-4E-55-3A
    vendor: Hanwha Techwin
    model: XNP-6120H

  authorization:
    login: admin
    password: Samsung1

  attributes:
    firmware: '1.00_170622'
    ptzCapabilities: 420417791  # Continuous & absolute everything, presets, etc.

  attributes if features.advanced_lens_control:
    ptzCapabilities: 428825855

  recording:
    primary: {codec: 'H264', resolution: '1920x1080', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '640x360', fps: [3, 10]}

  video_parameters:
    primary:
    - {codec: 'H264', resolution: '1920x1080'}
    - {codec: 'H265', resolution: '1280x1024'}
    - {codec: 'MJPEG', resolution: '1280x960'}
    secondary:
    - {codec: 'H264', resolution: '640x360', fps: [8, 12]}
    - {codec: 'H265', resolution: '320x240', fps: [13, 17]}
    - {codec: 'MJPEG', resolution: '640x480', fps: [24, 36]}
    stream_urls:
      "1": "rtsp://192.168.200.8:554/profile7/media.smp"
      "2": "rtsp://192.168.200.8:554/profile9/media.smp"

  audio_parameters:
    - {codec: 'AAC'}
    - {codec: 'MP2', 'set_codec': 'G711'}

  io_events:
    ins: [{id: 'AlarmInput.1', name: 'Alarm Input #1'}]
    outs: [{id: 'AlarmOutput.1', name: 'Alarm Output #1'}]

  ptz_positions if features.advanced_lens_control:
    - {point: '192-22-1', preset: '1:NxWitness1'}
    - {point: '37-25-2', preset: '2:WisenetWAV2'}
    - {point: '127-22-1', preset: '4:NxWitness4'}


Hikvision_DS-2CD2132F-IWS:
  discovery:
    physicalId: 28-57-BE-B7-12-D1
    vendor: Hikvision
    model: DS-2CD2132F-IWS

  authorization:
    login: admin
    password: Hikvision1

  attributes:
    firmware: V5.4.5 build 170123
    isAudioSupported: 1

  recording:
    primary: {codec: 'H264', resolution: '2048x1536', fps: [[13, 17], [8, 12]]}
    secondary: {codec: 'H264', resolution: '640x480', fps: [10, 20]}

  video_parameters:
    primary:
      - {codec: 'H264', resolution: '2048x1536'}
      - {codec: 'H264', resolution: '1920x1080'}
#    secondary:
#      - {codec: 'H264', resolution: '1280x720', fps: [8, 12]}
#      - {codec: 'H264', resolution: '640x480', fps: [13, 17]}

  # Also has G722 and MP2L2 in spec. But no advanced setting to switch to those.
  # "Audio stream was not discovered by ffprobe."
  audio_parameters if False:
    - {'skip_codec_change': True, codec: 'G711'}

  io_events:
    ins: [{id: '1', connected: 'AlarmOut_0'}]
    outs: [{id: 'AlarmOut_0'}]


Hikvision_DS-2CD2342WD-I:
  discovery:
    physicalId: 4C-BD-8F-E2-1C-87
    vendor: Hikvision
    model: DS-2CD2342WD-I

  authorization:
    login: admin
    password: Hikvision1

  attributes:
    firmware: V5.5.0 build 170725
    isAudioSupported: 0

  recording:
    primary: {codec: 'H264', resolution: '2688x1520', fps: [[15, 25], [8, 12]]}
    secondary: {codec: 'H264', resolution: '640x360', fps: [5, 10]}

  video_parameters:
    primary:
      - {codec: 'H264', resolution: '2688x1520'}
      - {codec: 'H264', resolution: '1920x1080'}
#    secondary:
#      - {codec: 'H264', resolution: '640x480', fps: [8, 12]}
#      - {codec: 'H264', resolution: '352x240', fps: [24, 36]}


Vista_VK2-1080VR:
  discovery:
    physicalId: urn_uuid_0007d817-0007-4d81-87a4-0007d817a4ea
    vendor: VISTA
    model: VK2-1080VRDIR37e
    mac: 00-07-D8-17-A4-EA

  authorization:
    password: auto

  attributes:
    firmware: 1.6.3-T8_release
    isAudioSupported: 0

  recording:
    primary: {codec: 'H264', resolution: '1920x1080', fps: [[13, 17]]} # TODO: More FPS.
    secondary: {codec: 'H264', resolution: '640x360', fps: [5, 10]}

  video_parameters:
#    primary:
#      - {codec: 'H264', resolution: '1920x1080'}
#      - {codec: 'H264', resolution: '1280x720'} # !resolution range is empty in all_cameras.json
#    secondary:
#      - {codec: 'H264', resolution: '480x360', fps: [8, 12]} # !resolution range is empty in all_cameras.json
#      - {codec: 'H264', resolution: '640x360', fps: [24, 36]} # fps range 1, 100 (sic!) in all_cameras.json
    stream_urls:
      "1": "rtsp://192.168.200.16:554/1/stream1/Profile1"
      "2": "rtsp://192.168.200.16:554/1/stream*/Profile*"
